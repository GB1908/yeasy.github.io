<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<title> gnuplot / fractal / recursive </title>
<!-- Generated 2002/4/14 -->
<!-- $Id: recursive.html,v 1.6 2004/12/04 10:01:51 kawano Exp $ -->
<meta http-equiv="content-type" content="text/html;charset=iso-2022-jp">
<link rel="stylesheet" href="../style-new.css" type="text/css">
</head>

<body>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr><td bgcolor="#cccc90" width="320">
    <div align="left">
    <a href="../index.html">
    <img src="../image/gnuplot_logo2.png" alt="GNUPLOT" width="320" height="90">
    </a></div></td>
    <td bgcolor="#cccc90">
      <div align="center"><h3> - not so Frequently Asked Questions - </h3> </div>
      <div class="update"> update 2004/11/29 </div>
    </td>
</tr>
<tr><td bgcolor="#fae8ba"></td>
    <td bgcolor="#fae8ba"><div class="navi"> 
<a href="../index.html">          HOME </a> |
<a href="../intro/index.html">    INTRODUCTION </a> |
<a href="../general.html">        INFORMATION </a> |
<a href="../gallery/index.html">  GALLERY </a> |
<a href="recursive-e.html">       ENGLISH </a>
</div></td></tr>
</table>
<hr class="topsep">


<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr><td id="menu">
 <p> <a href="index.html">   フラクタル  </a></p>

 <ul>
  <li><a href="recursive.html">  関数の再帰定義 </a>
  <li><a href="mandelbrot.html"> Mandelbrot集合 </a>
  <li><a href="selfsq.html">     Julia集合 (自己平方フラクタル) </a>
 </ul>
</td>

<td id="content">


<h1><a name="top"> 関数の再帰定義 </a></h1>

<p> gnuplotでは関数を再帰的に定義することができます．再帰的定義とは，
関数の定義式の中にその関数自身が含まれているものです．例えば，整数 N 
の階乗 N!=FAC(N)は FAC(N)=N*FAC(N-1) と書けますので，gnuplotでは次のよ
うに定義することができます．</p>

<pre class="sample">
gnuplot&gt; fac(n) = n * fac(n-1)
</pre>

<p> この1行で変数Nを1つづ減少させるloopのようになりますが，このままで
はNは負の無限大まで変化する無限ループとなってしまいますので，ループを
止める工夫が必要です．これには3項演算子を用います．N=0になったら再帰を
止めるようにするには，次のようにNに関する条件式を付けます．</p>

<pre class="sample">
gnuplot&gt; fac(n) = (n==0) ? 1 : n * fac(n-1)
</pre>

<p> 等号右側の<tt>(n==0)</tt>が条件式で，Nが0に等しいときに真になり，
その時は疑問符？のすぐ右を実行します．偽の場合はコロン：の右側を実行す
るので，再び自分自身である関数fac(n)をcallします．この判定により，N=0
になった時点でそれ以上関数fac(n)をcallするのを停止します．</p>

<p> N!を計算するには，Nが整数でなければいけません．これにはgnuplotの関
数int()を使って引数nの端数を切り落とします．この結果，引数が実数であっ
ても，常に整数の階乗を計算します．より厳密にはNが正であるという制限も
ありますが，ここでは入れていません．</p>

<pre class="sample">
gnuplot&gt; fac(x) = (int(x)==0) ? 1.0 : int(x) * fac(int(x)-1.0)
</pre>

<p> 関数fac(x)の計算結果は，次のようになりました．</p>

<pre class="sample">
gnuplot&gt; fac(x) = (int(x)==0) ? 1.0 : int(x) * fac(int(x)-1.0)
gnuplot&gt; print fact(1)
1.0
gnuplot&gt; print fact(5) 
120.0
gnuplot&gt; print fact(5.5) 
120.0
gnuplot&gt; print fact(20) 
2.43290200817664e+18
</pre>

<p> N!の近似値はStirlingの公式で計算できることが知られています．</p>

<div align="center"><img src="eq.png" alt="eq" width="289" height="39"></div>

<p> 上で定義した関数fac(x)とStirlingの公式の結果を比較してみましょう．</p>

<pre class="sample">
gnuplot&gt; stirling(x) = sqrt(2*pi*x) * x**x * exp(-x)
gnuplot&gt; set xrange [1:15]
gnuplot&gt; set yrange [1:1e+10]
gnuplot&gt; set log y
gnuplot&gt; set sample 15
gnuplot&gt; plot stirling(x) notitle with lines,\
&gt;             fact(x)     notitle with points
</pre>

<div align="center">
<img src="fact.png" alt="fact" width="400" height="300">
</div>

<div class="top"><a href="recursive.html#top"><img src="../image/mark-up.png" alt="up"></a></div>

</td>
</tr></table>
<hr class="topsep">

</body>
</html>
