<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<title> gnuplot / datafile (3)</title>
<!-- Generated 2003/ 6/ 6 -->
<!-- $Id: datafile3.html,v 1.6 2004/12/17 07:33:39 kawano Exp $ -->
<meta http-equiv="content-type" content="text/html;charset=iso-2022-jp">
<link rel="stylesheet" href="style-new.css" type="text/css">
</head>
<body>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr><td bgcolor="#cccc90" width="320">
    <a href="index.html">
    <div align="left"><img src="image/gnuplot_logo2.png" alt="GNUPLOT" width="320" height="90"></div>
    </a></td>
    <td bgcolor="#cccc90">
      <div align="center"><h3> - not so Frequently Asked Questions - </h3> </div>
      <div class="update"> update 2004/9/5 </div>
    </td>
</tr>
<tr><td bgcolor="#fae8ba"></td>
    <td bgcolor="#fae8ba"><div class="navi"> 
<a href="index.html">           HOME </a> |
<a href="intro/index.html">     INTRODUCTION </a> |
<a href="general.html">         INFORMATION </a> |
<a href="gallery/index.html">   GALLERY </a> |
<a href="datafile3-e.html">     ENGLISH </a>
</div></td></tr>
</table>
<hr class="topsep">


<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr><td id="menu">
 <p> not so FAQ</p>
  <ul>
    <li><a href="legend.html">      凡例(Legend) </a>
    <li><a href="tics.html">        目盛(Tics) </a>
    <li><a href="label.html">       ラベル(Label) </a>
    <li><a href="plot1.html">       2次元プロット </a>
    <li><a href="plot3d.html">      3次元プロット </a>
    <li><a href="polar.html">       極座標プロット </a>
    <li><a href="parametric.html">  媒介変数表示 </a>
    <li><a href="datafile.html">    データファイルの数値 </a>
    <ul>
      <li><a href="datafile.html#7.1">
           データフォーマット </a>
      <li><a href="datafile2.html#7.2">
           複数のデータをプロット</a>
      <li><a href="datafile2.html#7.3">
           数値の修正 </a>
      <li><a href="datafile2.html#7.4">
           データとコマンドの共存 </a>
      <li><a href="datafile2.html#7.5">
           データをスキップ </a>
      <li><a href="datafile2.html#7.6">
           一部をプロット</a>
      <li><a href="datafile3.html#7.7">
           UNIXのコマンド </a>
      <li><a href="datetime.html">
           日付/時間型データ </a>
    </ul>
    <li><a href="postproc.html">    図を描いたその後は</a>
    <li><a href="misc1.html">       その他 </a>
  </ul>
 <br>
</td>


<td id="content">


<h1><a name="top"> データファイルの数値のプロット (その3) </a></h1>

<div align="center">
<a href="datafile.html">  1 </a> | 
<a href="datafile2.html"> 2 </a> | 
<a href="datafile3.html"> 3 </a> |
<a href="datetime.html">  4 </a>
</div>



<h2><a name="7.7">UNIXのコマンドを利用する．</a></h2>

<p> gnuplotは<a href="datafile2.html#7.3">データファイルの中身を加工しな
     がらプロットする</a>ことができますが，gnuplotだけでは限界があります．
     例えば，X座標がa.dat，Y座標はb.datというように，データが複数のファ
     イルに分れていたり，特定の数値だけを修正するような場合です．あら
     かじめデータファイルをエディタで編集してgnuplot 用のデータを用意す
     るのが本筋ですが，ここではUNIXのコマンドを利用する方法を幾つか紹介
     します．</p>

<p> ここで取り上げているのは，以下のコマンドです．</p>

<ul>
 <li> <a href="datafile3.html#sort">  sort</a>
 <li> <a href="datafile3.html#paste"> paste </a>
 <li> <a href="datafile3.html#sed">   sed </a>
 <li> <a href="datafile3.html#awk">   awk </a>
</ul>


<h3><a name="sort">sort</a></h3>

<p> <tt>sort</tt>コマンドを使って，複数のファイルを連結して混ぜ合わせる
     ことができます．<p>

<table border="1">
<tr><td> file1.dat </td><td> file2.dat </td></tr>
<tr>
<td style="{background-color:#ffffff;width:320;}">
<pre>
   1.0   0.1
   2.0   0.2
   5.0   0.5
   8.0   0.8
</pre>
<td style="{background-color:#ffffff;width:320;}">
<pre>
   5.0   1.0
  10.0   1.2
  12.0   1.3
</pre>
</td></tr></table>


<pre class="sample">
 % sort -n file1.dat file2.dat
   1.0   0.1
   2.0   0.2
   4.0   0.6
   5.0   0.5
   5.0   1.0
   8.0   0.8
  10.0   1.2
  12.0   1.3
</pre>

<p> 2つのデータファイルを，それぞれ別のシンボルで表示した後，それら全部
 を繋ぐ線を引きます．</p>

<pre class="sample">
gnuplot&gt; plot "&lt; cat -n file1.dat file2.dat" using 1:2  w l,\
&gt;             "file1.dat" u 1:2 w p,\
&gt;             "file2.dat" u 1:2 w p
</pre>
 
<div align="center"><img src="fig/sample7.7a.png" alt="fig/sample7.7a" width="400" height="300"></div>


<h3><a name="paste"> paste </a></h3>

<p> <tt> paste </tt>コマンドは2つ以上のファイルを横に並べて書き出します．</p>

<table border="1">
<tr><td> file1.dat </td><td> file2.dat </td></tr>
<tr><td style="{background-color:#ffffff;width:320;}">
<pre>
   1.0   0.1
   2.0   0.2
   3.0   0.5
   4.0   0.8
</pre>
<td style="{background-color:#ffffff;width:320;}">
<pre>
   1.0   0.6
   2.0   1.0
   3.0   1.2
   4.0   1.3
</pre>
</td></tr></table>

<pre class="sample">
 % paste file1.dat file2.dat
   1.0   0.1       1.0   0.6
   2.0   0.2       2.0   1.0
   3.0   0.5       3.0   1.2
   4.0   0.8       4.0   1.3
</pre>

<p> file1.datのX座標とfile2.datのY座標を，(X,Y)として表示するには，次の
 ようにします．</p>

<pre class="sample">
gnuplot&gt; plot "&lt; paste file1.dat file2.dat" using 2:4  w lp
</pre>


<p>このコマンドを使って，2つのファイルに入っているデータの差や比を表示し
 ます．<tt> paste </tt>コマンドの出力では，file1.datのY座標が2カラム目，
 file2.datのY座標は4カラム目となりますので，2つの数値の差は
 <tt>$2-$4</tt>，比は<tt> $2/$4 </tt>と表されます．</p>

<pre class="sample">
gnuplot&gt; plot "&lt; paste file1.dat file2.dat" using 1:($2/$4) w points
</pre>
<div align="right"><i>  from Ken. Thanks !</i></div>



<h3><a name="sed"> sed </a></h3>

<p> ストリームエディタ<tt>sed</tt>を使と，大概のテキスト処理ができます．
     ここではsedの機能を全て網羅することはとてもできませんので，簡単な例
     だけを紹介します．データファイルは，上の例のfile1.datを用います．</p>

<p>X座標の1.0を1.2にずらす．</p>

<pre class="sample">
gnuplot&gt; plot '&lt;sed "s/^   1.0/   1.2/g" file1.dat'
</pre>

<p> 全部の点を表示するが，(2.0,0.2)の点だけ通らない線を描く．</p>

<pre class="sample">
gnuplot&gt; plot 'file1.dat'                   u 1:2 with points,\
&gt;             '&lt;sed "/^   2.0/d" file1.dat' u 1:2 with lines
</pre>

<div align="center"><img src="fig/sample7.7b.png" alt="fig/sample7.7b" width="400" height="300"></div>

<p> 3行目のデータだけを削除する．</p> 

<pre class="sample">
gnuplot&gt; plot '&lt;sed "3d" file1.dat' u 1:2 with points
</pre>




<h3><a name="awk"> awk </a></h3>

<p> <tt> awk </tt>も非常に協力な言語で，データファイルの各カラムに対して
     種々の操作を行えます．gnuplotで利用する方法は多々ありますが，要は
     awkコマンドの出力がgnuplotで表示できるような，XとYの2カラムになって
     いれば良いわけです．</p>

<p> Yデータの累積値を棒グラフで表示する．Yの値を順次加えていきます．最後
     の値が，Yの和になります．</p>

<pre class="sample">
gnuplot&gt; plot "&lt;awk '{x=x+$2; print $1,x}' file1.dat" with boxes
</pre>

<div align="center"><img src="fig/sample7.7c.png" alt="fig/sample7.7c" width="400" height="300"></div>

<p> Y座標が0.2より小さいときは，ゼロにする．</p>

<pre class="sample">
gnuplot&gt; plot  "&lt;awk '{print $1,($2<0.1) ? 0.0 : $2}' file1.dat" with lines
</pre>

<p> Xデータが[1:3]の間だけ，Y値を5倍する．</p>

<pre class="sample">
gnuplot&gt; plot  "&lt;awk '{print $1,($1&lt;=3 &amp;&amp; $1&gt;=1) ? $2*5 : $2}' file1.dat" with lines
</pre>

<div class="top"><a href="datafile3.html#top"><img src="image/mark-up.png" alt="up"></a></div>
</td></tr></table>
<hr class="topsep">


</body>
</html>

